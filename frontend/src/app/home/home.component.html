<!DOCTYPE html>
<html lang="en" class="body">
<div class="container">
  <!-- Page Title -->
  <div class="box-1">
    <h1 class="h1">Monthly Time Sheet</h1>
  </div>


  <!-- Card Top: Project / Month + Actions -->
  <div class="box-2">
    <div class="box-2-inside" style="display:flex;justify-content:space-between;align-items:center;gap:16px;flex-wrap:wrap;">
      <!-- Left: selectors -->
      <div style="display:flex;align-items:center;gap:28px;flex-wrap:wrap;">
        <div class="selectorBox">
          <p style="margin-right:6px;">Projects</p>
          <select [(ngModel)]="selectedProject"
                  (change)="onProjectChange()"
                  style="min-width:220px;height:36px;border:1px solid #ccc;border-radius:4px;padding:4px 8px;">
            <option *ngFor="let p of projects" [value]="p.name">{{ p.name }}</option>
          </select>
        </div>

        <!-- Month Selector -->
        <div class="selectorBox" style="display:flex;align-items:center;gap:10px;">
          <p style="margin:0 6px 0 0;">Select Month</p>

          <!-- Month Navigation Buttons -->
          <button type="button"
                  (click)="changeMonth(-1)"
                  aria-label="Previous month"
                  class="month-nav-btn">â€¹</button>

          <!-- Angular two-way binding for selected month -->
          <input type="month"
                 [(ngModel)]="selectedMonthValue"
                 (change)="onMonthChange()"
                 style="min-width:200px;
                height:36px;
                border:1px solid #ccc;
                border-radius:4px;
                padding:4px 8px;
                text-align:center;">

          <button type="button"
                  (click)="changeMonth(1)"
                  aria-label="Next month"
                  class="month-nav-btn">â€º</button>
        </div>
      </div>
      <!-- Right: actions -->
      <div style="display:flex;align-items:center;gap:12px;margin-left:auto;">
        <!--Will eventually replace with components-->
        <button class="button-exportToPDF">Export to PDF</button>
        <button class="button-save" style="background:#FBC900;border:none;">Edit</button>
        <button class="button-save" style="background:#FBC900;border:none;">Save</button>
      </div>
    </div>

    <!-- Selected Month Display-->
    <h2 class="h2-month">{{selectedMonth}}</h2>
  </div>

  <!-- Time Sheet Table Selection -->

  <div class="box-3">
    <div class="table-container">
      <table class="timesheet-table">
        <thead>
        <tr>
          <th style="text">Employee</th>
          <!-- Generate Days based on selected Month-->
          <th
            *ngFor="let day of daysInMonth"
            [ngClass]="{ 'weekend-col': isWeekend(day) }"
            [title]="getDowLabel(day)"
          >
            <div class="day-header">
              <div class="day-number">{{ day }}</div>
              <div class="day-dow">{{ getDowLabel(day) }}</div>
            </div>
          </th>
          <th>Total</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let employee of timesheetData.employees">

          <td>{{ employee.name }}</td>
          <td
            *ngFor="let day of daysInMonth"
            [ngClass]="{
              'holiday-cell': isHoliday(day),
              'weekend-cell': !isHoliday(day) && isWeekend(day),
              'current-day': isToday(day)
            }"
            [title]="isWeekend(day) ? 'Closed (Weekend)' : getHolidayName(day)">
            {{ employee.hours[day] || '' }}
          </td>
          <td>{{ getTotalHours(employee.hours) }}</td>
        </tr>
        </tbody>
      </table>
    </div>
    <div class="events-list"
         style="margin-top: 20px; padding: 10px; display: flex; justify-content: space-between; flex-wrap: wrap; align-items: flex-start;">

      <!-- Left: Events list -->
      <div style="flex: 1; min-width: 250px;">
        <span style="font-weight: bold;">Events This Month:</span>

        <ul *ngIf="formattedHolidays.length > 0; else noHolidays"
            style="margin-top: 10px; list-style-type: disc; padding-left: 24px;">
          <li *ngFor="let h of formattedHolidays">
            <strong>{{ h.date }}</strong> â€” {{ h.name }}
          </li>
        </ul>

        <ng-template #noHolidays>
          <p style="margin: 6px 0 0 0;">No holidays this month ðŸŽ‰</p>
        </ng-template>
      </div>

      <div class="legend-container"
           style="display: flex; align-items: center; gap: 20px; flex-wrap: wrap; margin-top: 10px;">
        <div class="legend" style="display: flex; align-items: center; gap: 16px;">
          <span class="weekendLegend"></span> Closed (Weekends)
          <span class="holidayLegend"></span> Holiday
        </div>
      </div>
    </div>
  </div>

  <!-- Month Heading -->
  <div class="box-4" style="border-top:none;padding-top:10px;">
    <div style="padding: 0 15px 0 15px;">
      <!-- Signature Lines -->
      <div style="display:flex;flex-wrap: wrap;gap:60px;justify-content:flex-start;margin-top:40px;">
        <div style="min-width:280px;">
          <div style="border-bottom:1px solid #ccc;height:28px;"></div>
          <p style="margin-top:6px;">Manager Signature</p>
        </div>
        <div style="min-width:180px;">
          <div style="border-bottom:1px solid #ccc;height:28px;"></div>
          <p style="margin-top:6px;">Date</p>
        </div>
      </div>
    </div>
  </div>
</div>
</html>
